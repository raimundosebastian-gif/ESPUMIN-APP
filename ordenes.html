<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Órdenes</title>
  <link rel="stylesheet" href="style.css">
  <!-- Para generar PNG optimizado para teléfono -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>

  <div id="header-container"></div>

  <main class="contenedor">

    <h2>Órdenes</h2>

    <!-- Búsqueda -->
    <div class="card">
      <input type="text" id="buscarOrden" placeholder="Buscar por número, cliente, estado..." class="input-buscar">
    </div>

    <!-- Formulario de carga / edición de orden -->
    <div class="card">
      <h3 id="tituloFormOrden">Nueva Orden</h3>

      <form id="formOrden" class="form">

        <!-- 1) Tipo de orden -->
        <label>Tipo de orden:</label>
        <select id="tipoOrden" required>
          <option value="">Seleccionar...</option>
          <option value="Lavandería">Lavandería</option>
          <option value="Tintorería">Tintorería</option>
        </select>

        <!-- 2) Numeración automática (no editable) -->
        <label>Número de orden:</label>
        <input type="text" id="numeroOrden" readonly placeholder="Se genera automáticamente">

        <!-- 3) Fecha de recepción -->
        <label>Fecha de recepción:</label>
        <input type="text" id="fechaIngreso" readonly>

        <!-- Cliente -->
        <label>Cliente:</label>
        <select id="clienteOrden" required>
          <option value="">Seleccionar...</option>
          <!-- Se completa por JS -->
        </select>

        <label>Teléfono cliente:</label>
        <input type="text" id="telefonoClienteOrden" readonly>

        <!-- 4) Protocolo Mascotas -->
        <label>Protocolo Mascotas:</label>
        <select id="protocoloMascotas" required>
          <option value="No">No</option>
          <option value="Sí">Sí</option>
        </select>

        <!-- Empleado (luego será automático por login) -->
        <label>Empleado que recibe:</label>
        <select id="empleadoOrden">
          <option value="">Seleccionar...</option>
          <!-- Se completa por JS -->
        </select>

        <!-- 5) Detalle de prendas -->
        <h4>Detalle de prendas</h4>

        <label>Producto:</label>
        <select id="productoOrden">
          <option value="">Seleccionar...</option>
          <!-- Se completa por JS filtrando por tipo -->
        </select>

        <label>Cantidad:</label>
        <input type="number" id="cantidadProducto" min="1" value="1">

        <button type="button" id="btnAgregarItem">Agregar ítem</button>

        <table class="tabla tabla-detalle">
          <thead>
            <tr>
              <th>Producto</th>
              <th>Categoría</th>
              <th>Cant.</th>
              <th>Precio unit.</th>
              <th>Subtotal</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="detalleOrden"></tbody>
        </table>

        <!-- 6) Cálculo -->
        <div class="totales-orden">
          <div><strong>Total:</strong> $<span id="totalOrden">0.00</span></div>

          <label>Pago parcial:</label>
          <input type="number" id="pagoParcial" min="0" step="0.01" value="0">

          <div><strong>Saldo:</strong> $<span id="saldoOrden">0.00</span></div>
        </div>

        <!-- 7) Método de pago -->
        <label>Método de pago:</label>
        <select id="metodoPago" required>
          <option value="">Seleccionar...</option>
          <option value="Efectivo">Efectivo</option>
          <option value="Transferencia">Transferencia</option>
          <option value="Débito">Débito</option>
          <option value="Crédito">Crédito</option>
        </select>

        <!-- 8) Dirección de entrega -->
        <label>Dirección de entrega (opcional):</label>
        <input type="text" id="direccionEntrega">

        <!-- 9) Fecha estimada de entrega (resaltada) -->
        <label class="label-resaltada">Fecha estimada de entrega:</label>
        <input type="date" id="fechaEntrega" required>

        <label>Observaciones:</label>
        <textarea id="obsOrden"></textarea>

        <button type="submit">Generar Orden</button>
      </form>
    </div>

    <!-- Listado de órdenes -->
    <div class="card">
      <h3>Órdenes generadas</h3>

      <table class="tabla">
        <thead>
          <tr>
            <th>Número</th>
            <th>Tipo</th>
            <th>Cliente</th>
            <th>Recepción</th>
            <th>Entrega estimada</th>
            <th>Estado</th>
            <th>Total</th>
            <th>Saldo</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="listaOrdenes"></tbody>
      </table>
    </div>

    <!-- Contenedor oculto para generar PNG -->
    <div id="previewOrden" class="preview-orden" style="display:none;"></div>

  </main>

  <script src="app.js"></script>
  <script src="ordenes.js"></script>
</body>
</html>
